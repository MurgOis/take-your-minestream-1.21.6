# Take Your MineStream Mod

## Обзор Проекта

Этот мод для Minecraft предназначен для отображения пользовательских сообщений прямо в игре. В текущей версии он позволяет игрокам устанавливать произвольное текстовое сообщение, которое затем может быть отображено на экране.

## Текущая Функциональность

Мод предоставляет команду `/minestream`, которая имеет две подкоманды:

- `/minestream message <ваше сообщение>`: Устанавливает текущее сообщение, которое будет отображаться. Это сообщение будет получено из аргумента `<ваше сообщение>`. После установки сообщения, оно будет выводиться в чат игроку.
- `/minestream stop`: Очищает текущее сообщение, прекращая его отображение. В чат игроку будет отправлено уведомление об остановке сообщений.

Внутренняя логика реализована в классах `MessageSpawner` и `MessageRenderer`. `MessageSpawner` отвечает за управление текущим сообщением, а `MessageRenderer` - за его отрисовку на экране.

## Интеграция с Twitch Chat (Реализация)

Мы успешно интегрировали чтение сообщений из Twitch чата. Для этого была использована библиотека `Twitch4J`.

### 1. Добавление Зависимости

Для начала, мы добавили зависимость `Twitch4J` в файл `build.gradle` проекта. Это позволило нам использовать функциональность `Twitch4J` для взаимодействия с Twitch API и IRC. Также была добавлена ссылка на репозиторий `mavenCentral()` для корректного разрешения зависимости.

```gradle
repositories {
    // ... existing repositories ...
    mavenCentral()
}

dependencies {
    // ... existing dependencies ...
    modImplementation "com.github.twitch4j:twitch4j:${project.twitch4j_version}"
}
```

Версия `Twitch4J` (например, `1.25.0`) была определена в файле `gradle.properties`:

```properties
twitch4j_version=1.25.0
```

### 2. `TwitchChatClient.java`

Был создан новый класс `TwitchChatClient.java` в директории `src/client/java/takeyourminestream/modid/`. Этот класс отвечает за управление подключением к Twitch IRC и обработку входящих сообщений.

- **Инициализация**: При создании экземпляра `TwitchChatClient`, он устанавливает соединение с IRC сервером Twitch. На данный момент, для простоты чтения публичного чата, не требуется сложная OAuth-авторизация; достаточно анонимного подключения.
- **Чтение Сообщений**: `TwitchChatClient` подписывается на событие `ChannelMessageEvent` из `Twitch4J`. При получении нового сообщения из чата, оно извлекает имя пользователя и текст сообщения.
- **Передача Сообщений в Игру**: Полученное сообщение (в формате "ИмяПользователя: Сообщение") затем передается в статический метод `MessageSpawner.setCurrentMessage()`, который отвечает за его отображение в Minecraft.
- **Подключение к Каналу**: При инициализации `TwitchChatClient` автоматически подключается к указанному Twitch каналу (например, `ijustseen_you`) с помощью метода `twitchClient.getChat().joinChannel(twitchChannelName)`.

### 3. Интеграция в `TakeYourMineStreamClient.java`

В главном классе клиента `TakeYourMineStreamClient.java` были внесены следующие изменения:

- **Экземпляр `TwitchChatClient`**: Объявлен статический экземпляр `TwitchChatClient`, чтобы управлять его жизненным циклом.
- **Автоматическое Подключение**: `TwitchChatClient` автоматически инициализируется при запуске мода, подключаясь к чату пользователя `ijustseen_you`.
- **Команды Управления**: Добавлены новые команды `/minestream twitch start` и `/minestream twitch stop` для ручного управления подключением к Twitch чату (запуска и остановки). Команда `/minestream stop` теперь также отключает Twitch чат.

```java
// Пример в TakeYourMineStreamClient.java
public class TakeYourMineStreamClient implements ClientModInitializer {

    private static TwitchChatClient twitchChatClient;

    @Override
    public void onInitializeClient() {
        // ... регистрация команд ...

        // Инициализация TwitchChatClient при запуске мода для указанного канала
        twitchChatClient = new TwitchChatClient("ijustseen_you");
    }
}
```

Эта реализация позволяет моду автоматически получать и отображать сообщения из чата Twitch в игре.

## Дополнительные Соображения

- **Конфигурация**: Моду потребуется файл конфигурации, где пользователь сможет указать свой Client ID, Client Secret, OAuth токен (или метод его получения) и имя канала Twitch.
- **Обработка Ошибок**: Реализовать надежную обработку ошибок для случаев, когда соединение с Twitch теряется, токен истекает или возникают другие проблемы.
- **Пользовательский Интерфейс (Опционально)**: Для более удобной настройки можно рассмотреть создание простого внутриигрового пользовательского интерфейса.
