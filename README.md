# Take Your MineStream Mod

## Обзор Проекта

Этот мод для Minecraft предназначен для отображения пользовательских сообщений прямо в игре. Он позволяет игрокам устанавливать произвольное текстовое сообщение, а также автоматически получает и отображает сообщения из чата Twitch.

## Функциональность

Мод предоставляет команду `/minestream`, которая имеет следующие подкоманды:

- `/minestream test <ваше сообщение>`: Устанавливает тестовое сообщение, которое будет отображаться в игре. Это сообщение будет получено из аргумента `<ваше сообщение>` и выведено в чат игроку.

- `/minestream stop`: Очищает текущее отображаемое сообщение, прекращая его показ. Также, если установлено подключение к Twitch чату, эта команда отключает его. В чат игроку будет отправлено уведомление об остановке сообщений.

- `/minestream twitch start`: Инициирует подключение к Twitch чату для указанного канала (по умолчанию `ijustseen_you`). Если подключение уже активно, будет выведено соответствующее уведомление.

- `/minestream twitch stop`: Отключается от Twitch чата, если он был активен. Если подключение неактивно, будет выведено соответствующее уведомление.

### Как работает интеграция с Twitch Chat:

Интеграция с Twitch чатом реализована с использованием библиотеки `Twitch4J`. Основные компоненты включают:

1.  **Добавление Зависимости**: В файл `build.gradle` была добавлена зависимость `com.github.twitch4j:twitch4j:${project.twitch4j_version}` и репозиторий `mavenCentral()`, что позволило использовать функциональность `Twitch4J`.

2.  **`TwitchChatClient.java`**: Новый класс, расположенный в `src/client/java/takeyourminestream/modid/`, управляет подключением к Twitch IRC и обработкой входящих сообщений. Он подписывается на событие `ChannelMessageEvent` из `Twitch4J`, извлекает имя пользователя и текст сообщения, а затем передает его в `MessageSpawner`.

3.  **Очередь Сообщений в `MessageSpawner.java`**: Чтобы избежать многократного повторения сообщений, `MessageSpawner` теперь использует очередь для обработки входящих сообщений. Каждое сообщение добавляется в очередь и отображается только один раз с заданной задержкой между ними. Это обеспечивает плавное и контролируемое отображение сообщений из чата.

4.  **Интеграция в `TakeYourMineStreamClient.java`**: Основной клиентский класс инициализирует `TwitchChatClient` при запуске мода, автоматически подключаясь к каналу `ijustseen_you`. Также здесь реализованы команды `/minestream twitch start` и `/minestream twitch stop` для ручного управления подключением.

Внутренняя логика отображения сообщений по-прежнему реализована в классах `MessageSpawner` и `MessageRenderer`. `MessageSpawner` управляет очередью сообщений и их появлением, а `MessageRenderer` отвечает за отрисовку на экране.

## Дополнительные Соображения

- **Настройка Канала**: В текущей реализации имя канала Twitch (`ijustseen_you`) жестко прописано в коде. В будущих версиях можно рассмотреть возможность настройки этого параметра через файл конфигурации или внутриигровую команду.
- **Авторизация для отправки сообщений**: Для отправки сообщений в Twitch чат или использования других функций Twitch API (например, получения информации о стриме), потребуется более сложная OAuth 2.0 авторизация.
- **Обработка Ошибок**: Необходимо реализовать более надежную обработку ошибок для случаев, когда соединение с Twitch теряется, возникают проблемы с API или другие сетевые неполадки.
- **Пользовательский Интерфейс (Опционально)**: Для более удобной настройки и управления модом можно рассмотреть создание простого внутриигрового пользовательского интерфейса (GUI).
